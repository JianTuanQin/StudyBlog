## 前言

本文是一种解决`tableview`快速滚动时引起的掉帧方案,如果有更好的思路可以指出.

[本文对应github链接](https://github.com/RPGLiker/RPGAsyncDrawCellDemo)

本文参考和学习了`YY大佬`的[文章链接](https://blog.ibireme.com/2015/11/12/smooth_user_interfaces_for_ios/)和这个异步绘制`cell`的项目[链接](https://github.com/johnil/VVeboTableViewDemo).看本文前请至少看完`YY`前辈的这篇文章!

## 解决思路

整体思路上就是在`时间`上提前计算,在`空间`上减少计算量,高效利用`CPU资源`!

- 1 不使用`AutoLayout`,直接使用`Frame`布局
- 2 减少控件数量
- 3 将圆角切割这样的事情不要使用离屏渲染这样的做法,而是直接画出来
- 4 将异步请求url的图片利用`CALayer`绘制
- 5 将其他控件利用`异步`绘制到一张图片,最后回到主线程展现图片
- 6 控制异步绘制线程`数量`,因为大量的切换线程实际上是一个极其消耗资源的过程
- 7 快速滚动时提供一种机制能取消绘制
- 8 其他可以采用的优化本文却没有使用的,欢迎补充

### 1 不使用`AutoLayout`,直接使用`Frame`布局

一般在`MVC`中`tableView`绘制,在数据源代理中会给`cell`传入`Model`,然后通过计算`AutoLayout`对应的`Frame`展示数据,我们可以把这个计算提前,在获取数据的时候就把`布局`,`cell高度`,`展示内容`计算好,渲染的时候直接拿来用就好了.思想上其实类似`MVVM`中`cell`的`VM`,只不过这个`"VM"`专门负责计算数据位置以及展示内容罢了.

如何使用请查看`demo`中`CellLayout`文件,下面举个例子:
